window.onload = function() {
	var log = [
	["10/23/11 10:00",0,1,0], // 2011-10-23
	["10/23/11 10:05",21,1,0],
	["10/23/11 10:10",0,1,0],
	["10/23/11 10:15",0,1,0],
	["10/23/11 10:20",6,1,0],
	["10/23/11 10:25",0,1,0],
	["10/23/11 10:30",0,1,0],
	["10/23/11 10:35",0,1,0],
	["10/23/11 10:40",0,1,0],
	["10/23/11 10:45",0,1,0],
	["10/23/11 10:50",0,1,0],
	["10/23/11 10:55",0,1,0],
	["10/23/11 11:00",0,1,0],
	["10/23/11 11:05",70,1,0],
	["10/23/11 11:10",105,1,0],
	["10/23/11 11:15",0,1,0],
	["10/23/11 11:20",21,1,0],
	["10/23/11 11:25",66,1,0],
	["10/23/11 11:30",9,1,0],
	["10/23/11 11:35",0,1,0],
	["10/23/11 11:40",7,1,0],
	["10/23/11 11:45",0,1,0],
	["10/23/11 11:50",0,1,0],
	["10/23/11 11:55",0,1,0],
	["10/23/11 12:00",5,1,0],
	["10/23/11 12:05",0,1,0],
	["10/23/11 12:10",22,1,0],
	["10/23/11 12:15",0,1,0],
	["10/23/11 12:20",0,1,0],
	["10/23/11 12:25",0,1,0],
	["10/23/11 12:30",0,1,0],
	["10/23/11 12:35",0,1,0],
	["10/23/11 12:40",0,1,0],
	["10/23/11 12:45",0,1,0],
	["10/23/11 12:50",0,1,0],
	["10/23/11 12:55",0,1,0],
	["10/23/11 13:00",0,1,0],
	["10/23/11 13:05",0,1,0],
	["10/23/11 13:10",0,1,0],
	["10/23/11 13:15",15,1,0],
	["10/23/11 13:20",0,1,0],
	["10/23/11 13:25",0,1,0],
	["10/23/11 13:30",0,1,0],
	["10/23/11 13:35",18,1,0],
	["10/23/11 13:40",0,1,0],
	["10/23/11 13:45",9,1,0],
	["10/23/11 13:50",0,1,0],
	["10/23/11 13:55",7,1,0],
	["10/23/11 14:00",33,1,0],
	["10/23/11 14:05",0,1,0],
	["10/23/11 14:10",89,0,1],
	["10/23/11 14:15",373,0,1],
	["10/23/11 14:20",576,0,1],
	["10/23/11 14:25",572,0,1],
	["10/23/11 14:30",571,0,1],
	["10/23/11 14:35",426,0,1],
	["10/23/11 14:40",122,0,1],
	["10/23/11 14:45",342,0,1],
	["10/23/11 14:50",497,0,1],
	["10/23/11 14:55",461,0,1],
	["10/23/11 15:00",538,0,1],
	["10/23/11 15:05",534,0,1],
	["10/23/11 15:10",520,0,1],
	["10/23/11 15:15",537,0,1],
	["10/23/11 15:20",420,0,1],
	["10/23/11 15:25",209,0,1],
	["10/23/11 15:30",464,0,1],
	["10/23/11 15:35",80,1,0],
	["10/23/11 15:40",77,1,0],
	["10/23/11 15:45",0,1,0],
	["10/23/11 15:50",0,1,0],
	["10/23/11 15:55",299,1,0],
	["10/23/11 16:00",538,0,1],
	["10/23/11 16:05",291,0,1],
	["10/23/11 16:10",0,0,1],
	["10/23/11 16:15",0,0,1],
	["10/23/11 16:20",0,0,1],
	["10/23/11 16:25",152,0,0],
	["10/23/11 16:30",38,0,0],
	["10/23/11 16:35",22,0,0],
	["10/23/11 16:40",101,0,0],
	["10/23/11 16:45",56,0,0],
	["10/23/11 16:50",0,0,0],
	["10/23/11 16:55",32,0,0],
	["10/23/11 17:00",34,0,0],
	["10/23/11 17:05",114,0,0],
	["10/23/11 17:10",156,0,0],
	["10/23/11 17:15",168,0,0],
	["10/23/11 17:20",175,0,1],
	["10/23/11 17:25",0,0,1],
	["10/23/11 17:30",0,0,1],
	["10/23/11 17:35",214,0,1],
	["10/23/11 17:40",359,0,1],
	["10/23/11 17:45",403,0,1],
	["10/23/11 17:50",181,0,1],
	["10/23/11 17:55",36,1,0],
	["10/23/11 18:00",32,1,0],
	["10/23/11 18:05",30,1,0],
	["10/23/11 18:10",20,1,0],
	["10/23/11 18:15",16,1,0],
	["10/23/11 18:20",6,1,0],
	["10/23/11 18:25",44,1,0],
	["10/23/11 18:30",33,1,0],
	["10/23/11 18:35",19,1,0],
	["10/23/11 18:40",23,1,0],
	["10/23/11 18:45",6,1,0],
	["10/23/11 18:50",0,1,0],
	["10/23/11 18:55",20,1,0],
	["10/23/11 19:00",0,1,0],
	["10/23/11 19:05",86,1,0],
	["10/23/11 19:10",82,1,0],
	["10/23/11 19:15",0,1,0],
	["10/23/11 19:20",0,1,0],
	["10/23/11 19:25",0,1,0],
	["10/23/11 19:30",0,1,0],
	["10/23/11 19:35",0,1,0],
	["10/23/11 19:40",0,1,0],
	["10/23/11 19:45",0,1,0],
	["10/23/11 19:50",0,1,0],
	["10/23/11 19:55",0,1,0],
	["10/23/11 20:00",0,1,0],
	["10/23/11 20:05",12,1,0],
	["10/23/11 20:10",0,1,0],
	["10/23/11 20:15",0,1,0],
	["10/23/11 20:20",0,1,0],
	["10/23/11 20:25",0,1,0],
	["10/23/11 20:30",0,1,0],
	["10/23/11 20:35",0,1,0],
	["10/23/11 20:40",0,1,0],
	["10/23/11 20:45",0,1,0],
	["10/23/11 20:50",0,1,0],
	["10/23/11 20:55",0,1,0],
	["10/23/11 21:00",0,1,0],
	["10/23/11 21:05",0,1,0],
	["10/23/11 21:10",0,1,0],
	["10/23/11 21:15",0,1,0],
	["10/23/11 21:20",0,1,0],
	["10/23/11 21:25",0,1,0],
	["10/23/11 21:30",0,1,0],
	["10/23/11 21:35",0,1,0],
	["10/23/11 21:40",0,1,0],
	["10/23/11 21:45",0,1,0],
	["10/23/11 21:50",0,1,0],
	["10/23/11 21:55",0,1,0],
	["10/23/11 22:00",0,1,0],
	["10/23/11 22:05",0,1,0],
	["10/23/11 22:10",0,1,0],
	["10/23/11 22:15",0,1,0],
	["10/23/11 22:20",0,1,0],
	["10/23/11 22:25",0,1,0],
	["10/23/11 22:30",0,1,0],
	["10/23/11 22:35",0,1,0],
	["10/23/11 22:40",0,1,0],
	["10/23/11 22:45",0,1,0],
	["10/23/11 22:50",0,1,0],
	["10/23/11 22:55",0,1,0],
	["10/23/11 23:00",0,1,0],
	["10/23/11 23:05",0,1,0],
	["10/23/11 23:10",0,1,0],
	["10/23/11 23:15",0,1,0],
	["10/23/11 23:20",0,1,0],
	["10/23/11 23:25",0,1,0],
	["10/23/11 23:30",0,1,0],
	["10/23/11 23:35",0,1,0],
	["10/23/11 23:40",0,1,0],
	["10/23/11 23:45",0,1,0],
	["10/23/11 23:50",0,1,0],
	["10/23/11 23:55",0,1,0],
	["10/24/11 0:00",0,1,0],
	["10/28/11 10:30",0,1,0], // 2011-10-28
	["10/28/11 10:35",24,1,0],
	["10/28/11 10:40",34,1,0],
	["10/28/11 10:45",21,1,0],
	["10/28/11 10:50",220,0,1],
	["10/28/11 10:55",299,0,1],
	["10/28/11 11:00",53,0,1],
	["10/28/11 11:05",15,0,1],
	["10/28/11 11:10",0,0,1],
	["10/28/11 11:15",0,0,1],
	["10/28/11 11:20",217,0,1],
	["10/28/11 11:25",255,0,1],
	["10/28/11 11:30",54,0,0],
	["10/28/11 11:35",142,0,0],
	["10/28/11 11:40",0,0,0],
	["10/28/11 11:45",0,0,0],
	["10/28/11 11:50",0,0,0],
	["10/28/11 11:55",0,0,0],
	["10/28/11 12:00",55,0,0],
	["10/28/11 12:05",74,0,0],
	["10/28/11 12:10",232,0,0],
	["10/28/11 12:15",297,0,0],
	["10/28/11 12:20",507,0,1],
	["10/28/11 12:25",0,0,1],
	["10/28/11 12:30",45,0,0],
	["10/28/11 12:35",52,0,0],
	["10/28/11 12:40",11,0,0],
	["10/28/11 12:45",48,0,0],
	["10/28/11 12:50",4,0,0],
	["10/28/11 12:55",181,0,1],
	["10/28/11 13:00",532,0,1],
	["10/28/11 13:05",266,0,1],
	["10/28/11 13:10",0,0,0],
	["10/28/11 13:15",0,0,0],
	["10/28/11 13:20",0,0,0],
	["10/28/11 13:25",0,0,0],
	["10/28/11 13:30",0,0,0],
	["10/28/11 13:35",0,0,0],
	["10/28/11 13:40",0,0,0],
	["10/28/11 13:45",0,0,0],
	["10/28/11 13:50",0,0,0],
	["10/28/11 13:55",0,0,0],
	["10/28/11 14:00",312,0,0],
	["10/28/11 14:05",175,0,0],
	["10/28/11 14:10",262,0,0],
	["10/28/11 14:15",0,0,0],
	["10/28/11 14:20",0,0,0],
	["10/28/11 14:25",0,0,0],
	["10/28/11 14:30",13,0,0],
	["10/28/11 14:35",0,0,0],
	["10/28/11 14:40",0,0,0],
	["10/28/11 14:45",0,0,0],
	["10/28/11 14:50",0,0,0],
	["10/28/11 14:55",0,0,0],
	["10/28/11 15:00",0,0,0],
	["10/28/11 15:05",0,0,0],
	["10/28/11 15:10",0,0,0],
	["10/28/11 15:15",0,0,0],
	["10/28/11 15:20",0,0,0],
	["10/28/11 15:25",0,0,0],
	["10/28/11 15:30",0,0,0],
	["10/28/11 15:35",0,0,0],
	["10/28/11 15:40",0,0,0],
	["10/28/11 15:45",56,0,0],
	["10/28/11 15:50",0,0,0],
	["10/28/11 15:55",0,0,0],
	["10/28/11 16:00",68,0,0],
	["10/28/11 16:05",0,0,0],
	["10/28/11 16:10",16,0,0],
	["10/28/11 16:15",0,0,0],
	["10/28/11 16:20",0,0,0],
	["10/28/11 16:25",0,0,0],
	["10/28/11 16:30",0,0,0],
	["10/28/11 16:35",0,0,0],
	["10/28/11 16:40",0,0,0],
	["10/28/11 16:45",0,0,0],
	["10/28/11 16:50",0,0,0],
	["10/28/11 16:55",0,0,0],
	["10/28/11 17:00",0,0,0],
	["10/28/11 17:05",54,0,0],
	["10/28/11 17:10",123,0,0],
	["10/28/11 17:15",0,0,0],
	["10/28/11 17:20",32,0,0],
	["10/28/11 17:25",0,0,0],
	["10/28/11 17:30",40,0,0],
	["10/28/11 17:35",112,0,0],
	["10/28/11 17:40",63,0,0],
	["10/28/11 17:45",43,0,0],
	["10/28/11 17:50",72,0,0],
	["10/28/11 17:55",11,0,0],
	["10/28/11 18:00",6,0,0],
	["10/28/11 18:05",11,0,0],
	["10/28/11 18:10",25,0,0],
	["10/28/11 18:15",4,0,0],
	["10/28/11 18:20",0,0,0],
	["10/28/11 18:25",174,0,0],
	["10/28/11 18:30",20,0,0],
	["10/28/11 18:35",15,0,0],
	["10/28/11 18:40",209,0,1],
	["10/28/11 18:45",534,0,1],
	["10/28/11 18:50",356,0,1],
	["10/28/11 18:55",326,0,1],
	["10/28/11 19:00",328,0,1],
	["10/28/11 19:05",334,0,1],
	["10/28/11 19:10",334,0,1],
	["10/28/11 19:15",271,0,1],
	["10/28/11 19:20",241,0,1],
	["10/28/11 19:25",193,0,1],
	["10/28/11 19:30",306,0,1],
	["10/28/11 19:35",494,0,1],
	["10/28/11 19:40",72,0,1],
	["10/28/11 19:45",73,0,1],
	["10/28/11 19:50",180,0,1],
	["10/28/11 19:55",35,1,0],
	["10/28/11 20:00",38,1,0],
	["10/28/11 20:05",23,1,0],
	["10/28/11 20:10",0,1,0],
	["10/28/11 20:15",29,1,0],
	["10/28/11 20:20",0,1,0],
	["10/28/11 20:25",0,1,0],
	["10/28/11 20:30",0,1,0],
	["10/28/11 20:35",0,1,0],
	["10/28/11 20:40",21,1,0],
	["10/28/11 20:45",97,1,0],
	["10/28/11 20:50",14,1,0],
	["10/28/11 20:55",0,1,0],
	["10/28/11 21:00",0,1,0],
	["10/28/11 21:05",0,1,0],
	["10/28/11 21:10",0,1,0],
	["10/28/11 21:15",0,1,0],
	["10/28/11 21:20",0,1,0],
	["10/28/11 21:25",0,1,0],
	["10/28/11 21:30",0,1,0],
	["10/28/11 21:35",0,1,0],
	["10/28/11 21:40",0,1,0],
	["10/28/11 21:45",0,1,0],
	["10/28/11 21:50",0,1,0],
	["10/28/11 21:55",0,1,0],
	["10/28/11 22:00",0,1,0],
	["10/28/11 22:05",0,1,0],
	["10/28/11 22:10",0,1,0],
	["10/28/11 22:15",0,1,0],
	["10/28/11 22:20",0,1,0],
	["10/28/11 22:25",0,1,0],
	["10/28/11 22:30",0,1,0],
	["10/28/11 22:35",0,1,0],
	["10/28/11 22:40",0,1,0],
	["10/28/11 22:45",0,1,0],
	["10/28/11 22:50",0,1,0],
	["10/28/11 22:55",0,1,0],
	["10/28/11 23:00",0,1,0],
	["10/28/11 23:05",0,1,0],
	["10/28/11 23:10",0,1,0],
	["10/28/11 23:15",0,1,0],
	["10/28/11 23:20",0,1,0],
	["10/28/11 23:25",0,1,0],
	["10/28/11 23:30",0,1,0],
	["10/28/11 23:35",0,1,0],
	["10/28/11 23:40",0,1,0],
	["10/28/11 23:45",42,1,0],
	["10/28/11 23:50",78,1,0],
	["10/28/11 23:55",58,1,0],
	["10/29/11 0:00",80,1,0],
	["10/29/11 0:05",75,1,0],
	["10/29/11 0:10",62,1,0],
	["10/29/11 0:15",27,1,0],
	["2011-11-01 10:55",0,1,0], // 2011-11-01
	["2011-11-01 11:00",69,1,0],
	["2011-11-01 11:05",271,0,1],
	["2011-11-01 11:10",571,0,1],
	["2011-11-01 11:15",569,0,1],
	["2011-11-01 11:20",602,0,1],
	["2011-11-01 11:25",632,0,1],
	["2011-11-01 11:30",610,0,1],
	["2011-11-01 11:35",607,0,0],
	["2011-11-01 11:40",258,0,0],
	["2011-11-01 11:45",0,0,0],
	["2011-11-01 11:50",6,0,0],
	["2011-11-01 11:55",0,0,0],
	["2011-11-01 12:00",0,0,0],
	["2011-11-01 12:05",183,0,0],
	["2011-11-01 12:10",132,0,0],
	["2011-11-01 12:15",0,0,0],
	["2011-11-01 12:20",0,0,0],
	["2011-11-01 12:25",0,0,0],
	["2011-11-01 12:30",0,0,0],
	["2011-11-01 12:35",0,0,0],
	["2011-11-01 12:40",0,0,0],
	["2011-11-01 12:45",0,0,0],
	["2011-11-01 12:50",0,0,0],
	["2011-11-01 12:55",0,0,0],
	["2011-11-01 13:00",16,0,0],
	["2011-11-01 13:05",304,0,0],
	["2011-11-01 13:10",57,0,0],
	["2011-11-01 13:15",0,0,0],
	["2011-11-01 13:20",0,0,0],
	["2011-11-01 13:25",0,0,0],
	["2011-11-01 13:30",0,0,0],
	["2011-11-01 13:35",0,0,0],
	["2011-11-01 13:40",0,0,0],
	["2011-11-01 13:45",0,0,0],
	["2011-11-01 13:50",53,0,0],
	["2011-11-01 13:55",0,0,0],
	["2011-11-01 14:00",0,0,0],
	["2011-11-01 14:05",67,0,0],
	["2011-11-01 14:10",0,0,0],
	["2011-11-01 14:15",0,0,0],
	["2011-11-01 14:20",0,0,0],
	["2011-11-01 14:25",0,0,0],
	["2011-11-01 14:30",0,0,0],
	["2011-11-01 14:35",0,0,0],
	["2011-11-01 14:40",0,0,0],
	["2011-11-01 14:45",0,0,0],
	["2011-11-01 14:50",0,0,0],
	["2011-11-01 14:55",0,0,0],
	["2011-11-01 15:00",0,0,0],
	["2011-11-01 15:05",0,0,0],
	["2011-11-01 15:10",0,0,0],
	["2011-11-01 15:15",0,0,0],
	["2011-11-01 15:20",0,0,0],
	["2011-11-01 15:25",0,0,0],
	["2011-11-01 15:30",209,0,0],
	["2011-11-01 15:35",13,0,0],
	["2011-11-01 15:40",0,0,0],
	["2011-11-01 15:45",0,0,0],
	["2011-11-01 15:50",0,0,0],
	["2011-11-01 15:55",0,0,0],
	["2011-11-01 16:00",0,0,0],
	["2011-11-01 16:05",0,0,0],
	["2011-11-01 16:10",0,0,0],
	["2011-11-01 16:15",0,0,0],
	["2011-11-01 16:20",0,0,0],
	["2011-11-01 16:25",0,0,0],
	["2011-11-01 16:30",0,0,0],
	["2011-11-01 16:35",0,0,0],
	["2011-11-01 16:40",0,0,0],
	["2011-11-01 16:45",0,0,0],
	["2011-11-01 16:50",0,0,0],
	["2011-11-01 16:55",167,0,0],
	["2011-11-01 17:00",239,0,0],
	["2011-11-01 17:05",349,0,1],
	["2011-11-01 17:10",47,0,1],
	["2011-11-01 17:15",0,0,1],
	["2011-11-01 17:20",16,0,1],
	["2011-11-01 17:25",510,0,1],
	["2011-11-01 17:30",167,1,0],
	["2011-11-01 17:35",26,1,0],
	["2011-11-01 17:40",56,1,0],
	["2011-11-01 17:45",86,0,1],
	["2011-11-01 17:50",0,0,1],
	["2011-11-01 17:55",0,0,0],
	["2011-11-01 18:00",131,0,0],
	["2011-11-01 18:05",129,0,0],
	["2011-11-01 18:10",0,0,0],
	["2011-11-01 18:15",203,0,0],
	["2011-11-01 18:20",98,0,0],
	["2011-11-01 18:25",86,0,0],
	["2011-11-01 18:30",0,0,1],
	["2011-11-01 18:35",0,0,1],
	["2011-11-01 18:40",164,1,0],
	["2011-11-01 18:45",5,1,0],
	["2011-11-01 18:50",12,1,0],
	["2011-11-01 18:55",8,1,0],
	["2011-11-01 19:00",0,1,0],
	["2011-11-01 19:05",4,1,0],
	["2011-11-01 19:10",55,1,0],
	["2011-11-01 19:15",40,1,0],
	["2011-11-01 19:20",18,1,0],
	["2011-11-01 19:25",0,1,0],
	["2011-11-01 19:30",0,1,0],
	["2011-11-01 19:35",0,1,0],
	["2011-11-01 19:40",11,1,0],
	["2011-11-01 19:45",30,1,0],
	["2011-11-01 19:50",13,1,0],
	["2011-11-01 19:55",6,1,0],
	["2011-11-01 20:00",0,1,0],
	["2011-11-01 20:05",0,1,0],
	["2011-11-01 20:10",0,1,0],
	["2011-11-01 20:15",26,1,0],
	["2011-11-01 20:20",86,1,0],
	["2011-11-01 20:25",0,1,0],
	["2011-11-01 20:30",0,1,0],
	["2011-11-01 20:35",0,1,0],
	["2011-11-01 20:40",0,1,0],
	["2011-11-01 20:45",0,1,0],
	["2011-11-01 20:50",0,1,0],
	["2011-11-01 20:55",0,1,0],
	["2011-11-01 21:00",0,1,0],
	["2011-11-01 21:05",0,1,0],
	["2011-11-01 21:10",0,1,0],
	["2011-11-01 21:15",0,1,0],
	["2011-11-01 21:20",0,1,0],
	["2011-11-01 21:25",0,1,0],
	["2011-11-01 21:30",0,1,0],
	["2011-11-01 21:35",0,1,0],
	["2011-11-01 21:40",0,1,0],
	["2011-11-01 21:45",0,1,0],
	["2011-11-01 21:50",0,1,0],
	["2011-11-01 21:55",0,1,0],
	["2011-11-01 22:00",17,1,0],
	["2011-11-01 22:05",28,1,0],
	["2011-11-01 22:10",43,1,0],
	["2011-11-01 22:15",10,1,0],
	["2011-11-01 22:20",32,1,0],
	["2011-11-01 22:25",0,1,0],
	["2011-11-01 22:30",0,1,0],
	["2011-11-01 22:35",0,1,0],
	["2011-11-01 22:40",0,1,0],
	["2011-11-01 22:45",0,1,0],
	["2011-11-01 22:50",0,1,0],
	["2011-11-01 22:55",0,1,0],
	["2011-11-01 23:00",0,1,0],
	["2011-11-01 23:05",0,1,0],
	["2011-11-01 23:10",4,1,0],
	["2011-11-01 23:15",349,1,0],
	["2011-11-01 23:20",394,1,0],
	["2011-11-01 23:25",410,1,0],
	["2011-11-01 23:30",430,1,0],
	["2011-11-01 23:35",317,1,0],
	["2011-11-01 23:40",249,1,0],
	["2011-11-01 23:45",13,1,0],
	["2011-11-01 23:50",93,1,0],
	["2011-11-01 23:55",115,1,0],
	["2011-11-01 23:59",0,1,0],
	];
	
	var dateIndex = 0;
	var stepsIndex = 1;
	var homeIndex = 2; // boolean: home or not
	var outIndex = 3; // boolean: outside or not
	
	var ww = 800;
	var wh = 800;
	var numTicks = log.length;
	var margin = ww/numTicks;
	
	var paper = Raphael("graph",ww,wh);
	//var border = paper.path("M0 0H"+ww+"V"+wh+"H0V0Z");
	var xStart = margin;
	var yStart = wh/2;
	var xLoc = xStart;
	var yLoc = yStart;
	var pathString = "M"+xStart+" "+yStart;
	
	var textPadding = 10;
	var speed = 200; // default:500 fast:100
	
	var homeBarGraph = function() {
		var midway = paper.path("M0 "+wh/2+"H"+ww);
		// separate by whether is home or not
		for(var i = 0; i < numTicks; i++) {
			xLoc = xLoc+margin;
			// if home, draw below half of y
			if (log[i][homeIndex] == 1) {
				yLoc = yStart+(log[i][stepsIndex])/2;
			} else {
				yLoc = yStart-(log[i][stepsIndex])/2;
			}
			pathString = pathString.concat("V"+yLoc+"M"+xLoc+" "+yStart);
		}
		pathString.concat("Z");
		paper.path(pathString);
	};
	
	function outdoorBarGraph() {
		var midway = paper.path("M0 "+wh/2+"H"+ww);
		//separate by whether indoors or outdoors
		for(var i = 0; i < numTicks; i++) {
			xLoc = xLoc+margin;
			// if home, draw below half of y
			if (log[i][outIndex] == 1) {
				yLoc = yStart-(log[i][stepsIndex])/2;
			} else {
				yLoc = yStart+(log[i][stepsIndex])/2;
			}
			pathString = pathString.concat("V"+yLoc+"M"+xLoc+" "+yStart);
		}
		pathString.concat("Z");
		paper.path(pathString);
	};
	
	function timeSpiral() {
		
		// time counter
		var time = paper.text(textPadding,textPadding,"");
		time.attr({"text-anchor":"start", "font-size":12, "fill":"#ffffff"});
		
		// init variables needed for circles and spiral
		var i = 0;
		var spiralArray = [];
		// circle's spiral path
		var deg = 20;
		var rVelocity = 2; // speed at which distance from center increases
		var thetaVelocity = deg*Math.PI/180; // angle at which dot moves along spiral
		
		setInterval(update,speed);
		function update() {
			if(i != numTicks) {
				time.attr("text",log[i][dateIndex]);
				
				// set up new circle
				var radius = log[i][stepsIndex]/15; // default:/15
				var color = setColor(log[i][homeIndex],log[i][outIndex]);
				//console.log(color);
				// draw circle and add it to spiralArray
				if (radius > 0) {
					var circle = paper.circle(ww/2,wh/2,radius);
					circle.attr({"stroke-width":0, "fill":color, "fill-opacity":0.9});
					//circle.attr({"cx":ww/2, "cy":wh/2});
					spiralArray.unshift({circle:circle, r:10, theta:0});
				}
				// place and move all circles in the array
				for (var j = 0; j < spiralArray.length; j++) {
					updateCircle(spiralArray[j]);
				}
				
				i++;
			}
		}

		//setInterval(updateCircle,100);
		function updateCircle(c) {
			c.r += rVelocity;
			c.theta += thetaVelocity;
			newcx = c.r * Math.cos(c.theta);
			newcy = c.r * Math.sin(c.theta);
			oldfill = c.circle.attr("fill-opacity");
			if (oldfill > 0.01) {
				c.circle.animate({cx:(ww/2)+newcx, cy:(wh/2)+newcy, "fill-opacity":(ww/2-c.r)/(ww/2)},speed);
			} else {
				c.circle.remove();
			}
		}
		
		function setColor(home,out) {
			var h;
			var s = 0.88;
			var b = 0.88;
			if (home) {
				h = Math.random() * 0.16; // red-yellow, hue 0-0.16
			}
			if (!home && out) {
				h = Math.random() * 0.39 + 0.19; // green-blue, hue 0.19-0.58
			}
			if (!home && !out) {
				h = Math.random() * 0.33 + 0.61; // purple-pink, hue 0.61-0.94
			}
			return "hsb("+h+","+s+","+b+")";
		}
	};
	
	// call visualization function
	timeSpiral();
	
}